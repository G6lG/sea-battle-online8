<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sea Battle Online - –ò–≥—Ä–∞–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üö¢</text></svg>">
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #3949ab;
            --accent: #ff4081;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --light: #f5f5f5;
            --dark: #121212;
            --ocean-dark: #0d47a1;
            --ocean-light: #1976d2;
            --ship-color: #7b1fa2;
            --hit-color: #ff5252;
            --miss-color: #448aff;
            --sunk-color: #37474f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--ocean-dark), var(--ocean-light));
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes wave {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px var(--accent); }
            50% { box-shadow: 0 0 20px var(--accent); }
        }

        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 0.8s ease-out;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .screen.active {
            display: block;
        }

        .hidden {
            display: none !important;
        }

        /* –•–µ–¥–µ—Ä */
        .header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 3.5rem;
            background: linear-gradient(90deg, #4fc3f7, #29b6f6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.3rem;
            color: #bbdefb;
            margin-bottom: 25px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .user-info {
            display: inline-flex;
            align-items: center;
            gap: 20px;
            background: rgba(26, 35, 126, 0.7);
            padding: 15px 30px;
            border-radius: 50px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .user-info span {
            font-weight: bold;
            color: #bbdefb;
            font-size: 1.1rem;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn i {
            font-size: 1.2rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), #283593);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(57, 73, 171, 0.4);
            background: linear-gradient(135deg, #303f9f, #1a237e);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #388e3c);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #f57c00);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 152, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #d32f2f);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(244, 67, 54, 0.4);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--accent), #f50057);
            color: white;
        }

        .btn-accent:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 64, 129, 0.4);
        }

        /* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è */
        .auth-container {
            max-width: 500px;
            margin: 50px auto;
            background: rgba(26, 35, 126, 0.9);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }

        .auth-tab {
            flex: 1;
            padding: 18px;
            background: rgba(57, 73, 171, 0.5);
            border: none;
            color: #c5cae9;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-tab.active {
            background: var(--secondary);
            color: white;
            font-weight: bold;
        }

        .auth-tab:hover {
            background: rgba(57, 73, 171, 0.8);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #e8eaf6;
            font-size: 1.1rem;
        }

        .form-group input {
            width: 100%;
            padding: 16px;
            border: 2px solid rgba(79, 195, 247, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.5);
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .auth-message {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .auth-message.success {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid var(--success);
            color: #c8e6c9;
            display: block;
        }

        .auth-message.error {
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid var(--danger);
            color: #ffcdd2;
            display: block;
        }

        /* –õ–æ–±–±–∏ */
        .lobby-container {
            background: rgba(26, 35, 126, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin: 30px auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .mode-card {
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
            padding: 35px;
            text-align: center;
            transition: all 0.4s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }

        .mode-card:hover::before {
            left: 100%;
        }

        .mode-card:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            border-color: #4fc3f7;
        }

        .mode-icon {
            font-size: 4rem;
            margin-bottom: 25px;
            color: #4fc3f7;
            animation: float 3s ease-in-out infinite;
        }

        .mode-card h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #bbdefb;
        }

        .mode-card p {
            color: #c5cae9;
            margin-bottom: 30px;
            line-height: 1.6;
            font-size: 1.1rem;
        }

        /* –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .social-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .panel-box {
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
            padding: 30px;
            max-height: 500px;
            overflow-y: auto;
        }

        .panel-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #4fc3f7;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(79, 195, 247, 0.3);
        }

        /* –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π */
        .friend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background: rgba(38, 50, 56, 0.5);
            border-radius: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .friend-item:hover {
            background: rgba(38, 50, 56, 0.8);
            transform: translateX(10px);
        }

        .friend-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .friend-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .friend-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
        }

        .friend-status.online {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
            animation: pulse 2s infinite;
        }

        .friend-status.offline {
            background: #78909c;
        }

        .friend-status.ingame {
            background: var(--warning);
            box-shadow: 0 0 10px var(--warning);
            animation: pulse 1.5s infinite;
        }

        /* –ß–∞—Ç */
        .chat-messages {
            height: 320px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            scroll-behavior: smooth;
        }

        .chat-message {
            padding: 12px 18px;
            margin-bottom: 15px;
            border-radius: 15px;
            background: rgba(57, 73, 171, 0.5);
            animation: fadeIn 0.3s ease-out;
        }

        .chat-message.own {
            background: rgba(76, 175, 80, 0.3);
            margin-left: 20%;
            border-left: 4px solid var(--success);
        }

        .chat-message.system {
            background: rgba(255, 152, 0, 0.3);
            font-style: italic;
            text-align: center;
            border-left: 4px solid var(--warning);
        }

        .chat-message .sender {
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-message .time {
            font-size: 0.9rem;
            color: #b0bec5;
        }

        .chat-input-container {
            display: flex;
            gap: 15px;
        }

        .chat-input {
            flex: 1;
            padding: 16px;
            border-radius: 12px;
            border: 2px solid rgba(79, 195, 247, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.5);
        }

        /* –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
        .game-container {
            background: rgba(26, 35, 126, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin: 30px auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 25px;
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .game-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-status {
            font-size: 2rem;
            font-weight: bold;
            color: #4fc3f7;
            animation: pulse 2s infinite;
        }

        .game-turn {
            font-size: 1.4rem;
            color: #bbdefb;
        }

        .game-timer {
            font-size: 1.3rem;
            color: #c5cae9;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
        }

        /* –ò–≥—Ä–æ–≤—ã–µ –ø–æ–ª—è */
        .game-boards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        @media (max-width: 1100px) {
            .game-boards {
                grid-template-columns: 1fr;
            }
        }

        .board-container {
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: transform 0.3s;
        }

        .board-container.active {
            transform: scale(1.03);
            box-shadow: 0 0 30px rgba(79, 195, 247, 0.5);
            border: 2px solid #4fc3f7;
        }

        .board-title {
            font-size: 2rem;
            margin-bottom: 25px;
            color: #bbdefb;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(10, 1fr);
            gap: 3px;
            width: 420px;
            height: 420px;
            margin: 0 auto;
            border: 3px solid #4fc3f7;
            background: rgba(13, 71, 161, 0.5);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        @media (max-width: 500px) {
            .game-board {
                width: 320px;
                height: 320px;
            }
        }

        .cell {
            background: rgba(79, 195, 247, 0.2);
            border: 1px solid rgba(79, 195, 247, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .cell:hover:not(.hit):not(.miss):not(.ship) {
            background: rgba(79, 195, 247, 0.4);
            transform: scale(1.1);
        }

        .cell.ship {
            background: rgba(123, 31, 162, 0.7);
            border-color: var(--ship-color);
        }

        .cell.ship::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            background: rgba(123, 31, 162, 0.5);
            border-radius: 50%;
        }

        .cell.hit {
            background: linear-gradient(135deg, var(--hit-color), #ff1744);
            animation: glow 1s infinite;
        }

        .cell.hit::after {
            content: "üí•";
            font-size: 1.8rem;
            animation: wave 0.5s ease-out;
        }

        .cell.miss {
            background: linear-gradient(135deg, var(--miss-color), #2979ff);
        }

        .cell.miss::after {
            content: "‚óã";
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .cell.sunk {
            background: linear-gradient(135deg, var(--sunk-color), #263238);
        }

        .cell.sunk::after {
            content: "üíÄ";
            font-size: 1.5rem;
        }

        /* –ü–∞–Ω–µ–ª—å –∫–æ—Ä–∞–±–ª–µ–π */
        .ships-panel {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 40px 0;
            padding: 30px;
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
        }

        .ship-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 15px 20px;
            background: rgba(38, 50, 56, 0.7);
            border-radius: 15px;
            transition: transform 0.3s;
        }

        .ship-item.placed {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .ship-item.placed .ship-cell {
            background: rgba(123, 31, 162, 0.7);
        }

        .ship-cell {
            width: 28px;
            height: 28px;
            background: var(--ship-color);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        .ship-info {
            margin-left: 15px;
            font-weight: bold;
            color: #4fc3f7;
            font-size: 1.1rem;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-container {
            background: rgba(26, 35, 126, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin: 30px auto;
            max-width: 1000px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(57, 73, 171, 0.7);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .stat-value {
            font-size: 3.5rem;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .stat-label {
            font-size: 1.3rem;
            color: #bbdefb;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: rgba(26, 35, 126, 0.95);
            padding: 50px;
            border-radius: 25px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(79, 195, 247, 0.5);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: #4fc3f7;
            font-size: 2rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: #ff4081;
        }

        .invite-code {
            font-size: 3rem;
            font-weight: bold;
            letter-spacing: 8px;
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin: 30px 0;
            border-radius: 15px;
            color: var(--success);
            font-family: monospace;
            text-shadow: 0 0 10px var(--success);
            animation: pulse 2s infinite;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */
        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1rem;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .connection-status.connected {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success);
            border: 2px solid var(--success);
        }

        .connection-status.disconnected {
            background: rgba(244, 67, 54, 0.2);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .connection-status .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .connection-status.connected .status-dot {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        .connection-status.disconnected .status-dot {
            background: var(--danger);
            box-shadow: 0 0 10px var(--danger);
        }

        /* –ó–≤—É–∫–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(26, 35, 126, 0.9);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            transition: all 0.3s;
            border: 2px solid rgba(79, 195, 247, 0.5);
        }

        .sound-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
        }

        /* –ó–∞–≥—Ä—É–∑—á–∏–∫ */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(18, 18, 18, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loader-spinner {
            width: 100px;
            height: 100px;
            border: 8px solid rgba(79, 195, 247, 0.3);
            border-top: 8px solid #4fc3f7;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin-bottom: 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loader-text {
            font-size: 1.5rem;
            color: #4fc3f7;
            text-align: center;
        }

        /* –§–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .ocean-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%231a237e" fill-opacity="0.5" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>');
            background-size: 100% 100%;
            animation: wave 15s linear infinite;
        }

        .wave:nth-child(2) {
            bottom: 20px;
            opacity: 0.7;
            animation: wave 20s linear infinite reverse;
        }

        .wave:nth-child(3) {
            bottom: 40px;
            opacity: 0.3;
            animation: wave 25s linear infinite;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .game-boards {
                grid-template-columns: 1fr;
            }
            
            .game-board {
                width: 320px;
                height: 320px;
            }
            
            .social-panel {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 30px;
            }
            
            .invite-code {
                font-size: 2rem;
                letter-spacing: 5px;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .auth-container,
            .lobby-container,
            .game-container {
                padding: 25px;
            }
            
            .game-board {
                width: 280px;
                height: 280px;
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
            
            .mode-card {
                padding: 25px;
            }
            
            .mode-icon {
                font-size: 3rem;
            }
            
            .mode-card h3 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- –§–æ–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã -->
    <div class="ocean-background">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
    <div class="connection-status disconnected" id="connection-status">
        <div class="status-dot"></div>
        <span id="status-text">–û—Ñ–ª–∞–π–Ω</span>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –∑–≤—É–∫–∞ -->
    <div class="sound-toggle" id="sound-toggle">
        <i class="fas fa-volume-up"></i>
    </div>
    
    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ Sea Battle Online...</div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div class="container">
        <!-- –•–µ–¥–µ—Ä -->
        <div class="header" id="header">
            <h1><i class="fas fa-anchor"></i> Sea Battle Online</h1>
            <p class="subtitle">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ "–ú–æ—Ä—Å–∫–æ–π –±–æ–π" –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–Ω–ª–∞–π–Ω-–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏. –°—Ä–∞–∂–∞–π—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞–º–∏!</p>
            <div class="user-info" id="user-info">
                <span id="username-display">–ì–æ—Å—Ç—å</span>
                <span id="user-rating">–†–µ–π—Ç–∏–Ω–≥: 1000</span>
                <div>
                    <button class="btn btn-primary" id="lobby-btn"><i class="fas fa-home"></i> –õ–æ–±–±–∏</button>
                    <button class="btn btn-warning" id="stats-btn"><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    <button class="btn btn-danger" id="logout-btn"><i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div class="screen active" id="auth-screen">
            <div class="auth-container">
                <div class="auth-tabs">
                    <button class="auth-tab active" id="login-tab">–í—Ö–æ–¥</button>
                    <button class="auth-tab" id="register-tab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                
                <div class="auth-form active" id="login-form">
                    <div class="form-group">
                        <label for="login-username"><i class="fas fa-user"></i> –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label for="login-password"><i class="fas fa-lock"></i> –ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button class="btn btn-primary btn-block" id="login-btn">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
                    <div class="auth-message" id="login-message"></div>
                </div>
                
                <div class="auth-form" id="register-form">
                    <div class="form-group">
                        <label for="register-username"><i class="fas fa-user"></i> –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" id="register-username" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω (3-15 —Å–∏–º–≤–æ–ª–æ–≤)">
                    </div>
                    <div class="form-group">
                        <label for="register-password"><i class="fas fa-lock"></i> –ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="register-password" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)">
                    </div>
                    <div class="form-group">
                        <label for="register-email"><i class="fas fa-envelope"></i> Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                        <input type="email" id="register-email" placeholder="example@mail.com">
                    </div>
                    <button class="btn btn-success btn-block" id="register-btn">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                    <div class="auth-message" id="register-message"></div>
                </div>
            </div>
        </div>
        
        <!-- –õ–æ–±–±–∏ -->
        <div class="screen" id="lobby-screen">
            <div class="lobby-container">
                <h2 style="text-align: center; margin-bottom: 40px; color: #4fc3f7; font-size: 2.5rem;">
                    <i class="fas fa-gamepad"></i> –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–≥—Ä—ã
                </h2>
                
                <div class="game-modes">
                    <div class="mode-card" id="mode-single">
                        <div class="mode-icon"><i class="fas fa-robot"></i></div>
                        <h3>–ü—Ä–æ—Ç–∏–≤ –ò–ò</h3>
                        <p>–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ—Å—å –ø—Ä–æ—Ç–∏–≤ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –î–æ—Å—Ç—É–ø–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Ç—Ç–∞—á–∏–≤–∞–Ω–∏—è –Ω–∞–≤—ã–∫–æ–≤.</p>
                        <button class="btn btn-primary" id="play-ai-btn">–ò–≥—Ä–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ –ò–ò</button>
                    </div>
                    
                    <div class="mode-card" id="mode-friend">
                        <div class="mode-icon"><i class="fas fa-user-friends"></i></div>
                        <h3>–° –¥—Ä—É–≥–æ–º</h3>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—É—é –∫–æ–º–Ω–∞—Ç—É –∏ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∞ –ø–æ –∫–æ–¥—É –∏–ª–∏ —Å—Å—ã–ª–∫–µ. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∏–≥—Ä—ã —Å –∑–Ω–∞–∫–æ–º—ã–º–∏.</p>
                        <button class="btn btn-success" id="create-room-btn">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                    </div>
                    
                    <div class="mode-card" id="mode-online">
                        <div class="mode-icon"><i class="fas fa-globe"></i></div>
                        <h3>–û–Ω–ª–∞–π–Ω-–º–∞—Ç—á</h3>
                        <p>–°—Ä–∞–∑–∏—Ç–µ—Å—å —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º –≤ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤–æ–º –º–∞—Ç—á–µ. –ü–æ–≤—ã—à–∞–π—Ç–µ —Å–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –∏ —Å—Ç–∞–Ω—å—Ç–µ –ª—É—á—à–∏–º!</p>
                        <button class="btn btn-warning" id="find-match-btn">–ù–∞–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</button>
                    </div>
                </div>
                
                <div class="social-panel">
                    <div class="panel-box">
                        <h3 class="panel-title"><i class="fas fa-users"></i> –û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏ <span id="online-count">(0)</span></h3>
                        <div id="online-players">
                            <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                            <div class="friend-item">
                                <div class="friend-info">
                                    <div class="friend-status online"></div>
                                    <div class="friend-avatar">AI</div>
                                    <div>
                                        <div class="friend-name">–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç</div>
                                        <div class="friend-rating">–†–µ–π—Ç–∏–Ω–≥: 1200</div>
                                    </div>
                                </div>
                                <button class="btn btn-primary btn-sm">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-box">
                        <h3 class="panel-title"><i class="fas fa-comments"></i> –ì–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç</h3>
                        <div class="chat-messages" id="global-chat">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                            <div class="chat-message system">
                                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏.
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <input type="text" class="chat-input" id="global-chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                            <button class="btn btn-primary" id="send-global-chat"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div class="screen" id="game-screen">
            <div class="game-container">
                <div class="game-header">
                    <div class="game-info">
                        <div class="game-status" id="game-status">–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä–∞–±–ª–µ–π</div>
                        <div class="game-turn" id="game-turn">–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –Ω–∞ –ø–æ–ª–µ</div>
                        <div class="game-timer">–í—Ä–µ–º—è: <span id="timer">00:00</span></div>
                    </div>
                    <div class="game-controls">
                        <button class="btn btn-danger" id="surrender-btn"><i class="fas fa-flag"></i> –°–¥–∞—Ç—å—Å—è</button>
                        <button class="btn btn-primary" id="back-to-lobby-btn"><i class="fas fa-home"></i> –í –ª–æ–±–±–∏</button>
                    </div>
                </div>
                
                <div class="game-boards">
                    <div class="board-container" id="player-board-container">
                        <h3 class="board-title"><i class="fas fa-user"></i> –í–∞—à–µ –ø–æ–ª–µ</h3>
                        <div class="game-board" id="player-board">
                            <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –∏–≥—Ä–æ–∫–∞ -->
                        </div>
                    </div>
                    
                    <div class="board-container" id="opponent-board-container">
                        <h3 class="board-title"><i class="fas fa-robot"></i> –ü–æ–ª–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞</h3>
                        <div class="game-board" id="opponent-board">
                            <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ -->
                        </div>
                    </div>
                </div>
                
                <div class="ships-panel">
                    <h3 style="width: 100%; text-align: center; color: #4fc3f7; margin-bottom: 20px; font-size: 1.5rem;">
                        <i class="fas fa-ship"></i> –í–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏
                    </h3>
                    <div class="ship-item" id="ship-4">
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-info">4-–ø–∞–ª—É–±–Ω—ã–π (x1)</div>
                    </div>
                    <div class="ship-item" id="ship-3">
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-info">3-–ø–∞–ª—É–±–Ω—ã–π (x2)</div>
                    </div>
                    <div class="ship-item" id="ship-2">
                        <div class="ship-cell"></div>
                        <div class="ship-cell"></div>
                        <div class="ship-info">2-–ø–∞–ª—É–±–Ω—ã–π (x3)</div>
                    </div>
                    <div class="ship-item" id="ship-1">
                        <div class="ship-cell"></div>
                        <div class="ship-info">1-–ø–∞–ª—É–±–Ω—ã–π (x4)</div>
                    </div>
                </div>
                
                <div class="game-controls" id="placement-controls">
                    <button class="btn btn-success" id="random-placement-btn"><i class="fas fa-random"></i> –ê–≤—Ç–æ—Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞</button>
                    <button class="btn btn-primary" id="rotate-ship-btn"><i class="fas fa-redo"></i> –ü–æ–≤–µ—Ä–Ω—É—Ç—å –∫–æ—Ä–∞–±–ª—å</button>
                    <button class="btn btn-warning" id="clear-ships-btn"><i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ</button>
                    <button class="btn btn-accent" id="start-game-btn"><i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É</button>
                </div>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div class="screen" id="stats-screen">
            <div class="stats-container">
                <h2 style="text-align: center; margin-bottom: 40px; color: #4fc3f7; font-size: 2.5rem;">
                    <i class="fas fa-chart-bar"></i> –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-games">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="wins">0</div>
                        <div class="stat-label">–ü–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="losses">0</div>
                        <div class="stat-label">–ü–æ—Ä–∞–∂–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="win-rate">0%</div>
                        <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="rating">1000</div>
                        <div class="stat-label">–†–µ–π—Ç–∏–Ω–≥ ELO</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="best-streak">0</div>
                        <div class="stat-label">–õ—É—á—à–∞—è —Å–µ—Ä–∏—è</div>
                    </div>
                </div>
                
                <h3 style="color: #4fc3f7; margin: 50px 0 20px; font-size: 1.8rem;">
                    <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–≥—Ä
                </h3>
                <div id="game-history" style="background: rgba(57, 73, 171, 0.7); border-radius: 15px; padding: 20px;">
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    <div style="text-align: center; padding: 40px; color: #c5cae9; font-size: 1.2rem;">
                        <i class="fas fa-clock" style="font-size: 3rem; margin-bottom: 20px; display: block;"></i>
                        –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä –ø–æ–∫–∞ –ø—É—Å—Ç–∞. –°—ã–≥—Ä–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ø–∞—Ä—Ç–∏—é!
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã -->
    <div class="modal hidden" id="create-room-modal">
        <div class="modal-content">
            <button class="modal-close" id="close-room-modal">&times;</button>
            <h2 style="color: #4fc3f7; margin-bottom: 20px;"><i class="fas fa-door-open"></i> –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</h2>
            <p style="color: #bbdefb; margin-bottom: 30px; line-height: 1.6;">
                –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—É—é –∫–æ–º–Ω–∞—Ç—É –¥–ª—è –∏–≥—Ä—ã —Å –¥—Ä—É–≥–æ–º. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥—Ä—É–≥—É, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è.
            </p>
            
            <div class="form-group">
                <label for="room-name"><i class="fas fa-heading"></i> –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <input type="text" id="room-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë–∏—Ç–≤–∞ —Ç–∏—Ç–∞–Ω–æ–≤">
            </div>
            
            <div class="form-group">
                <label for="room-privacy"><i class="fas fa-lock"></i> –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∫–æ–º–Ω–∞—Ç—ã</label>
                <select id="room-privacy" style="width: 100%; padding: 16px; border-radius: 10px; background: rgba(255, 255, 255, 0.1); color: white; border: 2px solid rgba(79, 195, 247, 0.3);">
                    <option value="private">–ü—Ä–∏–≤–∞—Ç–Ω–∞—è (—Ç–æ–ª—å–∫–æ –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é)</option>
                    <option value="public">–ü—É–±–ª–∏—á–Ω–∞—è (–≤–∏–¥—è—Ç –≤—Å–µ)</option>
                </select>
            </div>
            
            <div style="margin: 40px 0;">
                <h3 style="color: #4fc3f7; margin-bottom: 20px;">–ö–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                <div class="invite-code" id="room-invite-code">ABCD123</div>
                <p style="color: #c5cae9; margin-top: 15px; font-size: 0.9rem;">–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 24 —á–∞—Å–∞</p>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <button class="btn btn-success" id="copy-invite-code-btn"><i class="fas fa-copy"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
                <button class="btn btn-primary" id="share-invite-btn"><i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                <button class="btn btn-accent" id="create-room-confirm-btn"><i class="fas fa-check"></i> –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
    <div class="modal hidden" id="invite-modal">
        <div class="modal-content">
            <button class="modal-close" id="close-invite-modal">&times;</button>
            <h2 style="color: #4fc3f7; margin-bottom: 20px;"><i class="fas fa-user-plus"></i> –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –∏–≥—Ä—É</h2>
            <p style="color: #bbdefb; margin-bottom: 30px; line-height: 1.6;">
                –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∏–≥—Ä–µ —Å –¥—Ä—É–≥–æ–º.
            </p>
            
            <div class="form-group">
                <label for="invite-code-input"><i class="fas fa-key"></i> –ö–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</label>
                <input type="text" id="invite-code-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä: ABCD123">
            </div>
            
            <div style="margin: 40px 0; text-align: center;">
                <button class="btn btn-success" id="join-by-invite-btn" style="padding: 18px 40px; font-size: 1.2rem;">
                    <i class="fas fa-sign-in-alt"></i> –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∏–≥—Ä–µ
                </button>
            </div>
            
            <div style="border-top: 2px solid rgba(79, 195, 247, 0.3); padding-top: 20px;">
                <p style="color: #c5cae9; text-align: center; font-size: 0.9rem;">
                    –ò–ª–∏ –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –¥—Ä—É–≥ –ø—Ä–∏—à–ª–µ—Ç –≤–∞–º —Å—Å—ã–ª–∫—É —Å –∫–æ–¥–æ–º
                </p>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–≥—Ä—ã -->
    <div class="modal hidden" id="result-modal">
        <div class="modal-content">
            <h2 id="result-title" style="color: #4fc3f7; margin-bottom: 20px; font-size: 2.5rem;"></h2>
            <div id="result-icon" style="font-size: 5rem; margin: 30px 0; text-align: center;"></div>
            <p id="result-message" style="color: #bbdefb; margin-bottom: 30px; line-height: 1.6; font-size: 1.3rem; text-align: center;"></p>
            
            <div style="background: rgba(0, 0, 0, 0.3); padding: 25px; border-radius: 15px; margin: 30px 0;">
                <h3 style="color: #4fc3f7; margin-bottom: 15px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="color: #c5cae9;">–í—Ä–µ–º—è –∏–≥—Ä—ã: <span id="result-time" style="color: #4fc3f7; font-weight: bold;">00:00</span></div>
                    <div style="color: #c5cae9;">–í–∞—à–∏ –≤—ã—Å—Ç—Ä–µ–ª—ã: <span id="result-shots" style="color: #4fc3f7; font-weight: bold;">0</span></div>
                    <div style="color: #c5cae9;">–¢–æ—á–Ω–æ—Å—Ç—å: <span id="result-accuracy" style="color: #4fc3f7; font-weight: bold;">0%</span></div>
                    <div style="color: #c5cae9;">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞: <span id="result-rating-change" style="color: #4fc3f7; font-weight: bold;">+0</span></div>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-primary" id="play-again-btn"><i class="fas fa-redo"></i> –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                <button class="btn btn-accent" id="back-to-lobby-from-result-btn"><i class="fas fa-home"></i> –í –ª–æ–±–±–∏</button>
            </div>
        </div>
    </div>
    
    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="shot-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-laser-gun-shot-1678.mp3" type="audio/mpeg">
    </audio>
    <audio id="hit-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-explosion-2759.mp3" type="audio/mpeg">
    </audio>
    <audio id="miss-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-water-splash-1332.mp3" type="audio/mpeg">
    </audio>
    <audio id="sunk-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-ship-horn-1250.mp3" type="audio/mpeg">
    </audio>
    <audio id="win-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>
    <audio id="lose-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-losing-bleeps-2026.mp3" type="audio/mpeg">
    </audio>
    <audio id="click-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π JavaScript –∫–æ–¥ -->
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –°–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                document.getElementById('loader').classList.add('hidden');
            }, 1500);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
            initApp();
        });
        
        // –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç –∏–≥—Ä—ã
        const SeaBattle = {
            // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            currentUser: null,
            
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            gameState: {
                mode: null, // 'ai', 'friend', 'online'
                status: 'setup', // 'setup', 'player_turn', 'opponent_turn', 'ended'
                playerBoard: [],
                opponentBoard: [],
                playerShips: [],
                opponentShips: [],
                placedShips: 0,
                currentShipSize: 4,
                shipOrientation: 'horizontal',
                selectedShip: null,
                gameTime: 0,
                timerInterval: null,
                totalShots: 0,
                hits: 0,
                roomId: null,
                opponent: null,
                isSoundOn: true,
                difficulty: 'medium' // 'easy', 'medium', 'hard'
            },
            
            // –ó–≤—É–∫–∏
            sounds: {
                shot: document.getElementById('shot-sound'),
                hit: document.getElementById('hit-sound'),
                miss: document.getElementById('miss-sound'),
                sunk: document.getElementById('sunk-sound'),
                win: document.getElementById('win-sound'),
                lose: document.getElementById('lose-sound'),
                click: document.getElementById('click-sound')
            },
            
            // –°–∏–º—É–ª—è—Ü–∏—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            ws: {
                connected: false,
                rooms: [],
                onlinePlayers: [],
                chatMessages: [],
                simulateConnection() {
                    this.connected = true;
                    document.getElementById('status-text').textContent = '–û–Ω–ª–∞–π–Ω';
                    document.getElementById('connection-status').className = 'connection-status connected';
                    
                    // –°–∏–º—É–ª–∏—Ä—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
                    this.onlinePlayers = [
                        { id: 1, name: '–ö–∞–ø–∏—Ç–∞–Ω', rating: 1250, status: 'online' },
                        { id: 2, name: '–ú–æ—Ä—è–∫', rating: 1100, status: 'online' },
                        { id: 3, name: '–ü–∏—Ä–∞—Ç', rating: 980, status: 'ingame' },
                        { id: 4, name: '–ê–¥–º–∏—Ä–∞–ª', rating: 1450, status: 'online' }
                    ];
                    
                    this.updateOnlinePlayers();
                    
                    // –°–∏–º—É–ª–∏—Ä—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
                    this.chatMessages = [
                        { user: '–°–∏—Å—Ç–µ–º–∞', text: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Sea Battle Online!', time: '10:00', type: 'system' },
                        { user: '–ö–∞–ø–∏—Ç–∞–Ω', text: '–ö—Ç–æ —Ö–æ—á–µ—Ç —Å—ã–≥—Ä–∞—Ç—å?', time: '10:05', type: 'player' },
                        { user: '–ú–æ—Ä—è–∫', text: '–Ø –≥–æ—Ç–æ–≤!', time: '10:06', type: 'player' }
                    ];
                    
                    this.updateChat();
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    this.showNotification('–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'success');
                },
                
                disconnect() {
                    this.connected = false;
                    document.getElementById('status-text').textContent = '–û—Ñ–ª–∞–π–Ω';
                    document.getElementById('connection-status').className = 'connection-status disconnected';
                    this.showNotification('–û—Ç–∫–ª—é—á–µ–Ω–æ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞', 'error');
                },
                
                createRoom(roomName, isPrivate) {
                    const roomId = this.generateRoomId();
                    const room = {
                        id: roomId,
                        name: roomName || `–ö–æ–º–Ω–∞—Ç–∞ ${roomId}`,
                        creator: SeaBattle.currentUser.username,
                        players: [SeaBattle.currentUser.username],
                        maxPlayers: 2,
                        isPrivate: isPrivate,
                        status: 'waiting'
                    };
                    
                    this.rooms.push(room);
                    this.showNotification(`–ö–æ–º–Ω–∞—Ç–∞ "${room.name}" —Å–æ–∑–¥–∞–Ω–∞!`, 'success');
                    return roomId;
                },
                
                generateRoomId() {
                    return Math.random().toString(36).substring(2, 8).toUpperCase();
                },
                
                joinRoom(roomId) {
                    const room = this.rooms.find(r => r.id === roomId);
                    if (!room) {
                        this.showNotification('–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                        return false;
                    }
                    
                    if (room.players.length >= room.maxPlayers) {
                        this.showNotification('–ö–æ–º–Ω–∞—Ç–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞', 'error');
                        return false;
                    }
                    
                    room.players.push(SeaBattle.currentUser.username);
                    this.showNotification(`–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ "${room.name}"`, 'success');
                    return true;
                },
                
                sendChatMessage(message, isGlobal = true) {
                    const chatMsg = {
                        user: SeaBattle.currentUser.username,
                        text: message,
                        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                        type: 'player'
                    };
                    
                    this.chatMessages.push(chatMsg);
                    this.updateChat();
                    
                    // –°–∏–º—É–ª–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —á–∞—Ç–µ
                    if (isGlobal && Math.random() > 0.7) {
                        setTimeout(() => {
                            const botResponses = [
                                '–ü—Ä–∏–≤–µ—Ç! –î–∞–≤–∞–π —Å—ã–≥—Ä–∞–µ–º!',
                                '–ö—Ç–æ –≤—ã–∏–≥—Ä–∞–ª –ø–æ—Å–ª–µ–¥–Ω—é—é –∏–≥—Ä—É?',
                                '–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞ —Å–µ–≥–æ–¥–Ω—è!',
                                '–ö—Ç–æ —Ö–æ—á–µ—Ç –≤ –∫–æ–º–∞–Ω–¥—É?',
                                '–ú–æ–π —Ä–µ–π—Ç–∏–Ω–≥ —Å–µ–≥–æ–¥–Ω—è –ø–æ–¥–Ω—è–ª—Å—è!'
                            ];
                            
                            const randomResponse = botResponses[Math.floor(Math.random() * botResponses.length)];
                            const botMsg = {
                                user: ['–ö–∞–ø–∏—Ç–∞–Ω', '–ú–æ—Ä—è–∫', '–ü–∏—Ä–∞—Ç'][Math.floor(Math.random() * 3)],
                                text: randomResponse,
                                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                                type: 'player'
                            };
                            
                            this.chatMessages.push(botMsg);
                            this.updateChat();
                        }, 1000 + Math.random() * 3000);
                    }
                },
                
                updateOnlinePlayers() {
                    const container = document.getElementById('online-players');
                    if (!container) return;
                    
                    container.innerHTML = '';
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –ò–ò –∫–∞–∫ –∏–≥—Ä–æ–∫–∞
                    const aiPlayer = document.createElement('div');
                    aiPlayer.className = 'friend-item';
                    aiPlayer.innerHTML = `
                        <div class="friend-info">
                            <div class="friend-status online"></div>
                            <div class="friend-avatar" style="background: linear-gradient(135deg, #ff4081, #f50057);">AI</div>
                            <div>
                                <div class="friend-name">–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç</div>
                                <div class="friend-rating">–†–µ–π—Ç–∏–Ω–≥: 1200</div>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-sm" onclick="SeaBattle.startGame('ai')">–ò–≥—Ä–∞—Ç—å</button>
                    `;
                    container.appendChild(aiPlayer);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
                    this.onlinePlayers.forEach(player => {
                        const playerElement = document.createElement('div');
                        playerElement.className = 'friend-item';
                        playerElement.innerHTML = `
                            <div class="friend-info">
                                <div class="friend-status ${player.status}"></div>
                                <div class="friend-avatar">${player.name.charAt(0)}</div>
                                <div>
                                    <div class="friend-name">${player.name}</div>
                                    <div class="friend-rating">–†–µ–π—Ç–∏–Ω–≥: ${player.rating}</div>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="SeaBattle.invitePlayer('${player.name}')">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
                        `;
                        container.appendChild(playerElement);
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
                    document.getElementById('online-count').textContent = `(${this.onlinePlayers.length + 1})`;
                },
                
                updateChat() {
                    const container = document.getElementById('global-chat');
                    if (!container) return;
                    
                    container.innerHTML = '';
                    
                    this.chatMessages.forEach(msg => {
                        const messageElement = document.createElement('div');
                        messageElement.className = `chat-message ${msg.type === 'system' ? 'system' : (msg.user === SeaBattle.currentUser.username ? 'own' : '')}`;
                        
                        if (msg.user === SeaBattle.currentUser.username) {
                            messageElement.innerHTML = `
                                <div class="sender">
                                    –í—ã
                                    <span class="time">${msg.time}</span>
                                </div>
                                <div>${msg.text}</div>
                            `;
                        } else {
                            messageElement.innerHTML = `
                                <div class="sender">
                                    ${msg.user}
                                    <span class="time">${msg.time}</span>
                                </div>
                                <div>${msg.text}</div>
                            `;
                        }
                        
                        container.appendChild(messageElement);
                    });
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                    container.scrollTop = container.scrollHeight;
                },
                
                showNotification(message, type = 'info') {
                    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    const notification = document.createElement('div');
                    notification.className = `auth-message ${type}`;
                    notification.textContent = message;
                    notification.style.position = 'fixed';
                    notification.style.top = '80px';
                    notification.style.right = '20px';
                    notification.style.zIndex = '1000';
                    notification.style.maxWidth = '300px';
                    
                    document.body.appendChild(notification);
                    
                    // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        notification.remove();
                    }, 3000);
                }
            },
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            initApp() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                this.loadUser();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö –ø–æ–ª–µ–π
                this.initGameBoards();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
                this.initEventListeners();
                
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
                setTimeout(() => {
                    this.ws.simulateConnection();
                }, 2000);
            },
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUser() {
                const savedUser = localStorage.getItem('seaBattleUser');
                if (savedUser) {
                    try {
                        this.currentUser = JSON.parse(savedUser);
                        this.showScreen('lobby');
                        this.updateUserDisplay();
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                        this.showScreen('auth');
                    }
                } else {
                    this.showScreen('auth');
                }
            },
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            saveUser() {
                if (this.currentUser) {
                    localStorage.setItem('seaBattleUser', JSON.stringify(this.currentUser));
                    
                    // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ "–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"
                    const users = JSON.parse(localStorage.getItem('seaBattleUsers') || '{}');
                    users[this.currentUser.username] = this.currentUser;
                    localStorage.setItem('seaBattleUsers', JSON.stringify(users));
                }
            },
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            updateUserDisplay() {
                if (this.currentUser) {
                    document.getElementById('username-display').textContent = this.currentUser.username;
                    document.getElementById('user-rating').textContent = `–†–µ–π—Ç–∏–Ω–≥: ${this.currentUser.rating || 1000}`;
                    document.getElementById('user-info').style.display = 'inline-flex';
                }
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤
            showScreen(screenName) {
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
                document.getElementById(`${screenName}-screen`).classList.add('active');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Ö–µ–¥–µ—Ä
                document.getElementById('header').style.display = screenName === 'auth' ? 'none' : 'block';
                
                // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫ –∫–ª–∏–∫–∞
                this.playSound('click');
            },
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö –ø–æ–ª–µ–π
            initGameBoards() {
                // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ –¥–æ—Å–∫–∏
                this.gameState.playerBoard = this.createEmptyBoard();
                this.gameState.opponentBoard = this.createEmptyBoard();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–æ—Å–∫—É –∏–≥—Ä–æ–∫–∞
                const playerBoard = document.getElementById('player-board');
                playerBoard.innerHTML = '';
                
                for (let row = 0; row < 10; row++) {
                    for (let col = 0; col < 10; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.dataset.row = row;
                        cell.dataset.col = col;
                        cell.addEventListener('click', () => this.handlePlayerBoardClick(row, col));
                        playerBoard.appendChild(cell);
                    }
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–æ—Å–∫—É –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
                const opponentBoard = document.getElementById('opponent-board');
                opponentBoard.innerHTML = '';
                
                for (let row = 0; row < 10; row++) {
                    for (let col = 0; col < 10; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.dataset.row = row;
                        cell.dataset.col = col;
                        cell.addEventListener('click', () => this.handleOpponentBoardClick(row, col));
                        opponentBoard.appendChild(cell);
                    }
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ—Ä–∞–±–ª–∏
                this.initShips();
            },
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–π –¥–æ—Å–∫–∏
            createEmptyBoard() {
                const board = [];
                for (let i = 0; i < 10; i++) {
                    board.push(Array(10).fill(0)); // 0 - –ø—É—Å—Ç–æ, 1 - –∫–æ—Ä–∞–±–ª—å, 2 - –ø–æ–ø–∞–¥–∞–Ω–∏–µ, 3 - –ø—Ä–æ–º–∞—Ö
                }
                return board;
            },
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä–∞–±–ª–µ–π
            initShips() {
                this.gameState.playerShips = [
                    { size: 4, positions: [], placed: false, sunk: false },
                    { size: 3, positions: [], placed: false, sunk: false },
                    { size: 3, positions: [], placed: false, sunk: false },
                    { size: 2, positions: [], placed: false, sunk: false },
                    { size: 2, positions: [], placed: false, sunk: false },
                    { size: 2, positions: [], placed: false, sunk: false },
                    { size: 1, positions: [], placed: false, sunk: false },
                    { size: 1, positions: [], placed: false, sunk: false },
                    { size: 1, positions: [], placed: false, sunk: false },
                    { size: 1, positions: [], placed: false, sunk: false }
                ];
                
                this.gameState.opponentShips = [
                    { size: 4, positions: [], sunk: false },
                    { size: 3, positions: [], sunk: false },
                    { size: 3, positions: [], sunk: false },
                    { size: 2, positions: [], sunk: false },
                    { size: 2, positions: [], sunk: false },
                    { size: 2, positions: [], sunk: false },
                    { size: 1, positions: [], sunk: false },
                    { size: 1, positions: [], sunk: false },
                    { size: 1, positions: [], sunk: false },
                    { size: 1, positions: [], sunk: false }
                ];
            },
            
            // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
            startGame(mode) {
                this.gameState.mode = mode;
                this.gameState.status = 'setup';
                this.gameState.placedShips = 0;
                this.gameState.currentShipSize = 4;
                this.gameState.shipOrientation = 'horizontal';
                this.gameState.totalShots = 0;
                this.gameState.hits = 0;
                
                // –°–±—Ä–æ—Å –¥–æ—Å–æ–∫
                this.initGameBoards();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                document.getElementById('game-status').textContent = '–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä–∞–±–ª–µ–π';
                document.getElementById('game-turn').textContent = '–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –Ω–∞ –ø–æ–ª–µ';
                document.getElementById('start-game-btn').style.display = 'inline-flex';
                
                // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
                if (mode === 'ai') {
                    document.querySelector('#opponent-board-container .board-title').innerHTML = '<i class="fas fa-robot"></i> –ü–æ–ª–µ –ò–ò';
                    this.placeOpponentShips();
                } else if (mode === 'friend') {
                    document.querySelector('#opponent-board-container .board-title').innerHTML = '<i class="fas fa-user-friends"></i> –ü–æ–ª–µ –¥—Ä—É–≥–∞';
                } else if (mode === 'online') {
                    document.querySelector('#opponent-board-container .board-title').innerHTML = '<i class="fas fa-globe"></i> –ü–æ–ª–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
                this.showScreen('game');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π
                this.updateShipsDisplay();
            },
            
            // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ (–ò–ò)
            placeOpponentShips() {
                const shipSizes = [4, 3, 3, 2, 2, 2, 1, 1, 1, 1];
                let shipIndex = 0;
                
                for (const size of shipSizes) {
                    let placed = false;
                    let attempts = 0;
                    
                    while (!placed && attempts < 100) {
                        const row = Math.floor(Math.random() * 10);
                        const col = Math.floor(Math.random() * 10);
                        const orientation = Math.random() > 0.5 ? 'horizontal' : 'vertical';
                        
                        if (this.canPlaceShip(this.gameState.opponentBoard, row, col, size, orientation)) {
                            // –†–∞–∑–º–µ—â–∞–µ–º –∫–æ—Ä–∞–±–ª—å
                            const positions = [];
                            
                            if (orientation === 'horizontal') {
                                for (let c = col; c < col + size; c++) {
                                    this.gameState.opponentBoard[row][c] = 1;
                                    positions.push({ row, col: c });
                                }
                            } else {
                                for (let r = row; r < row + size; r++) {
                                    this.gameState.opponentBoard[r][col] = 1;
                                    positions.push({ row: r, col });
                                }
                            }
                            
                            this.gameState.opponentShips[shipIndex].positions = positions;
                            placed = true;
                            shipIndex++;
                        }
                        attempts++;
                    }
                }
            },
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–æ—Ä–∞–±–ª—è
            canPlaceShip(board, row, col, size, orientation) {
                if (orientation === 'horizontal') {
                    if (col + size > 10) return false;
                    for (let c = col; c < col + size; c++) {
                        if (board[row][c] !== 0) return false;
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
                        for (let r = Math.max(0, row - 1); r <= Math.min(9, row + 1); r++) {
                            for (let c2 = Math.max(0, c - 1); c2 <= Math.min(9, c + 1); c2++) {
                                if (board[r][c2] !== 0) return false;
                            }
                        }
                    }
                } else {
                    if (row + size > 10) return false;
                    for (let r = row; r < row + size; r++) {
                        if (board[r][col] !== 0) return false;
                        for (let r2 = Math.max(0, r - 1); r2 <= Math.min(9, r + 1); r2++) {
                            for (let c = Math.max(0, col - 1); c <= Math.min(9, col + 1); c++) {
                                if (board[r2][c] !== 0) return false;
                            }
                        }
                    }
                }
                return true;
            },
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Å–≤–æ–µ–π –¥–æ—Å–∫–µ (—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π)
            handlePlayerBoardClick(row, col) {
                if (this.gameState.status !== 'setup') return;
                
                const shipSize = this.getCurrentShipSize();
                if (!shipSize) return;
                
                if (this.canPlaceShip(this.gameState.playerBoard, row, col, shipSize, this.gameState.shipOrientation)) {
                    this.placeShip(row, col, shipSize, this.gameState.shipOrientation);
                    this.playSound('click');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –∫–æ—Ä–∞–±–ª–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã
                    if (this.gameState.placedShips === 10) {
                        document.getElementById('game-turn').textContent = '–í—Å–µ –∫–æ—Ä–∞–±–ª–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã! –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É"';
                    }
                } else {
                    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
                    const cell = document.querySelector(`#player-board .cell[data-row="${row}"][data-col="${col}"]`);
                    cell.style.backgroundColor = 'rgba(244, 67, 54, 0.5)';
                    setTimeout(() => {
                        cell.style.backgroundColor = '';
                    }, 300);
                }
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ—Ä–∞–±–ª—è –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
            getCurrentShipSize() {
                for (const ship of this.gameState.playerShips) {
                    if (!ship.placed) {
                        return ship.size;
                    }
                }
                return null;
            },
            
            // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è
            placeShip(row, col, size, orientation) {
                const shipIndex = this.gameState.playerShips.findIndex(ship => ship.size === size && !ship.placed);
                if (shipIndex === -1) return;
                
                const positions = [];
                
                if (orientation === 'horizontal') {
                    for (let c = col; c < col + size; c++) {
                        this.gameState.playerBoard[row][c] = 1;
                        positions.push({ row, col: c });
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        const cell = document.querySelector(`#player-board .cell[data-row="${row}"][data-col="${c}"]`);
                        cell.classList.add('ship');
                    }
                } else {
                    for (let r = row; r < row + size; r++) {
                        this.gameState.playerBoard[r][col] = 1;
                        positions.push({ row: r, col });
                        
                        const cell = document.querySelector(`#player-board .cell[data-row="${r}"][data-col="${col}"]`);
                        cell.classList.add('ship');
                    }
                }
                
                this.gameState.playerShips[shipIndex].positions = positions;
                this.gameState.playerShips[shipIndex].placed = true;
                this.gameState.placedShips++;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π
                this.updateShipsDisplay();
            },
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä–∞–±–ª–µ–π
            updateShipsDisplay() {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –∫–æ—Ä–∞–±–ª—è
                this.gameState.playerShips.forEach((ship, index) => {
                    const shipElement = document.getElementById(`ship-${ship.size}`);
                    if (shipElement) {
                        if (ship.placed) {
                            shipElement.classList.add('placed');
                        } else {
                            shipElement.classList.remove('placed');
                        }
                    }
                });
            },
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä–∞–±–ª–µ–π
            placeShipsRandomly() {
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ
                this.initGameBoards();
                this.gameState.playerBoard = this.createEmptyBoard();
                this.gameState.placedShips = 0;
                
                // –†–∞–∑–º–µ—â–∞–µ–º –∫–æ—Ä–∞–±–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
                const shipSizes = [4, 3, 3, 2, 2, 2, 1, 1, 1, 1];
                
                for (const size of shipSizes) {
                    let placed = false;
                    let attempts = 0;
                    
                    while (!placed && attempts < 100) {
                        const row = Math.floor(Math.random() * 10);
                        const col = Math.floor(Math.random() * 10);
                        const orientation = Math.random() > 0.5 ? 'horizontal' : 'vertical';
                        
                        if (this.canPlaceShip(this.gameState.playerBoard, row, col, size, orientation)) {
                            this.placeShip(row, col, size, orientation);
                            placed = true;
                        }
                        attempts++;
                    }
                }
                
                document.getElementById('game-turn').textContent = '–ö–æ—Ä–∞–±–ª–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É"';
                this.playSound('win');
            },
            
            // –ü–æ–≤–æ—Ä–æ—Ç –∫–æ—Ä–∞–±–ª—è
            rotateShip() {
                this.gameState.shipOrientation = this.gameState.shipOrientation === 'horizontal' ? 'vertical' : 'horizontal';
                this.playSound('click');
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
                const btn = document.getElementById('rotate-ship-btn');
                btn.style.transform = 'rotate(180deg)';
                setTimeout(() => {
                    btn.style.transform = '';
                }, 300);
            },
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –¥–æ—Å–∫–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ (–≤—ã—Å—Ç—Ä–µ–ª)
            handleOpponentBoardClick(row, col) {
                if (this.gameState.status !== 'player_turn') return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—Ç—Ä–µ–ª—è–ª–∏ –ª–∏ —É–∂–µ –≤ —ç—Ç—É –∫–ª–µ—Ç–∫—É
                const cell = document.querySelector(`#opponent-board .cell[data-row="${row}"][data-col="${col}"]`);
                if (cell.classList.contains('hit') || cell.classList.contains('miss')) {
                    return;
                }
                
                // –î–µ–ª–∞–µ–º –≤—ã—Å—Ç—Ä–µ–ª
                this.gameState.totalShots++;
                this.playSound('shot');
                const isHit = this.gameState.opponentBoard[row][col] === 1;
                
                if (isHit) {
                    // –ü–æ–ø–∞–¥–∞–Ω–∏–µ
                    cell.classList.add('hit');
                    this.gameState.opponentBoard[row][col] = 2;
                    this.gameState.hits++;
                    this.playSound('hit');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω –ª–∏ –∫–æ—Ä–∞–±–ª—å
                    const shipIndex = this.gameState.opponentShips.findIndex(ship => 
                        ship.positions.some(pos => pos.row === row && pos.col === col)
                    );
                    
                    if (shipIndex !== -1) {
                        const ship = this.gameState.opponentShips[shipIndex];
                        const hitPosition = ship.positions.findIndex(pos => pos.row === row && pos.col === col);
                        
                        if (hitPosition !== -1) {
                            // –ü–æ–º–µ—á–∞–µ–º –ø–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –∫–æ—Ä–∞–±–ª—å
                            if (!ship.positions[hitPosition].hit) {
                                ship.positions[hitPosition].hit = true;
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω –ª–∏ –≤–µ—Å—å –∫–æ—Ä–∞–±–ª—å
                                if (ship.positions.every(pos => pos.hit)) {
                                    ship.sunk = true;
                                    this.playSound('sunk');
                                    
                                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ—Ç–æ–ø–ª–µ–Ω–Ω—ã–π –∫–æ—Ä–∞–±–ª—å
                                    ship.positions.forEach(pos => {
                                        const sunkCell = document.querySelector(
                                            `#opponent-board .cell[data-row="${pos.row}"][data-col="${pos.col}"]`
                                        );
                                        if (sunkCell) {
                                            sunkCell.classList.add('sunk');
                                        }
                                    });
                                    
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω—ã –ª–∏ –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏
                                    if (this.gameState.opponentShips.every(s => s.sunk)) {
                                        this.endGame(true);
                                        return;
                                    }
                                }
                            }
                        }
                    }
                    
                    // –ï—Å–ª–∏ –ø–æ–ø–∞–ª–∏, —Ö–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è —É –∏–≥—Ä–æ–∫–∞
                    document.getElementById('game-turn').textContent = '–ü–æ–ø–∞–¥–∞–Ω–∏–µ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∞—Ç–∞–∫—É';
                } else {
                    // –ü—Ä–æ–º–∞—Ö
                    cell.classList.add('miss');
                    this.gameState.opponentBoard[row][col] = 3;
                    this.playSound('miss');
                    
                    // –ü–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫—É
                    this.gameState.status = 'opponent_turn';
                    document.getElementById('game-status').textContent = '–•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞';
                    document.getElementById('game-turn').textContent = '–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –¥—É–º–∞–µ—Ç...';
                    
                    // –í —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Ç–∏–≤ –ò–ò - –ò–ò –¥–µ–ª–∞–µ—Ç —Ö–æ–¥
                    if (this.gameState.mode === 'ai') {
                        setTimeout(() => this.makeAIMove(), 800);
                    }
                }
            },
            
            // –•–æ–¥ –ò–ò
            makeAIMove() {
                if (this.gameState.status !== 'opponent_turn') return;
                
                // "–£–º–Ω—ã–π" –∞–ª–≥–æ—Ä–∏—Ç–º –ò–ò
                let row, col;
                let found = false;
                
                // 1. –ò—â–µ–º —Ä–∞–Ω–µ–Ω—ã–π –∫–æ—Ä–∞–±–ª—å (–¥–ª—è –ø—Ä–∏—Ü–µ–ª—å–Ω–æ–≥–æ –æ–≥–Ω—è)
                for (let r = 0; r < 10 && !found; r++) {
                    for (let c = 0; c < 10 && !found; c++) {
                        if (this.gameState.playerBoard[r][c] === 2) { // –ü–æ–ø–∞–¥–∞–Ω–∏–µ
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏
                            const directions = [[-1, 0], [1, 0], [0, -1], [0, 1]];
                            for (const [dr, dc] of directions) {
                                const nr = r + dr;
                                const nc = c + dc;
                                if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) {
                                    if (this.gameState.playerBoard[nr][nc] === 0) { // –ï—â–µ –Ω–µ —Å—Ç—Ä–µ–ª—è–ª–∏
                                        row = nr;
                                        col = nc;
                                        found = true;
                                        break;
                                    }
                                }
                            }
                        }
                    }
                }
                
                // 2. –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, —Å—Ç—Ä–µ–ª—è–µ–º –ø–æ —à–∞–±–ª–æ–Ω—É (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
                if (!found) {
                    const strategy = this.getAIStrategy();
                    const emptyCells = [];
                    
                    for (let r = 0; r < 10; r++) {
                        for (let c = 0; c < 10; c++) {
                            if (this.gameState.playerBoard[r][c] === 0) {
                                emptyCells.push({ r, c });
                            }
                        }
                    }
                    
                    if (emptyCells.length === 0) return;
                    
                    // –í—ã–±–∏—Ä–∞–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                    if (strategy === 'smart') {
                        // "–£–º–Ω–∞—è" —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: —Å—Ç—Ä–µ–ª—è–µ–º –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª—è–º, –≥–¥–µ —á–∞—â–µ –≤—Å–µ–≥–æ —Ä–∞–∑–º–µ—â–∞—é—Ç –∫–æ—Ä–∞–±–ª–∏
                        const priorityCells = emptyCells.filter(cell => 
                            (cell.r + cell.c) % 2 === 0 || // –ß–µ—Ç–Ω—ã–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
                            (cell.r % 2 === 0 && cell.c % 2 === 0) // –ß–µ—Ç–Ω—ã–µ –∫–ª–µ—Ç–∫–∏
                        );
                        
                        const targetCells = priorityCells.length > 0 ? priorityCells : emptyCells;
                        const randomIndex = Math.floor(Math.random() * targetCells.length);
                        row = targetCells[randomIndex].r;
                        col = targetCells[randomIndex].c;
                    } else {
                        // –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã—Å—Ç—Ä–µ–ª
                        const randomIndex = Math.floor(Math.random() * emptyCells.length);
                        row = emptyCells[randomIndex].r;
                        col = emptyCells[randomIndex].c;
                    }
                }
                
                // –î–µ–ª–∞–µ–º –≤—ã—Å—Ç—Ä–µ–ª
                this.gameState.totalShots++;
                setTimeout(() => {
                    this.playSound('shot');
                    
                    const cell = document.querySelector(`#player-board .cell[data-row="${row}"][data-col="${col}"]`);
                    const isHit = this.gameState.playerBoard[row][col] === 1;
                    
                    if (isHit) {
                        // –ü–æ–ø–∞–¥–∞–Ω–∏–µ –ò–ò
                        cell.classList.add('hit');
                        this.gameState.playerBoard[row][col] = 2;
                        this.playSound('hit');
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω –ª–∏ –∫–æ—Ä–∞–±–ª—å
                        const shipIndex = this.gameState.playerShips.findIndex(ship => 
                            ship.positions.some(pos => pos.row === row && pos.col === col)
                        );
                        
                        if (shipIndex !== -1) {
                            const ship = this.gameState.playerShips[shipIndex];
                            const hitPosition = ship.positions.findIndex(pos => pos.row === row && pos.col === col);
                            
                            if (hitPosition !== -1 && !ship.positions[hitPosition].hit) {
                                ship.positions[hitPosition].hit = true;
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω –ª–∏ –≤–µ—Å—å –∫–æ—Ä–∞–±–ª—å
                                if (ship.positions.every(pos => pos.hit)) {
                                    ship.sunk = true;
                                    this.playSound('sunk');
                                    
                                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ—Ç–æ–ø–ª–µ–Ω–Ω—ã–π –∫–æ—Ä–∞–±–ª—å
                                    ship.positions.forEach(pos => {
                                        const sunkCell = document.querySelector(
                                            `#player-board .cell[data-row="${pos.row}"][data-col="${pos.col}"]`
                                        );
                                        if (sunkCell) {
                                            sunkCell.classList.add('sunk');
                                        }
                                    });
                                    
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Ç–æ–ø–ª–µ–Ω—ã –ª–∏ –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏
                                    if (this.gameState.playerShips.every(s => s.sunk)) {
                                        this.endGame(false);
                                        return;
                                    }
                                }
                            }
                        }
                        
                        // –ò–ò –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ö–æ–¥, –µ—Å–ª–∏ –ø–æ–ø–∞–ª
                        setTimeout(() => this.makeAIMove(), 1000);
                    } else {
                        // –ü—Ä–æ–º–∞—Ö –ò–ò
                        cell.classList.add('miss');
                        this.gameState.playerBoard[row][col] = 3;
                        this.playSound('miss');
                        
                        // –ü–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥ –∏–≥—Ä–æ–∫—É
                        this.gameState.status = 'player_turn';
                        document.getElementById('game-status').textContent = '–í–∞—à —Ö–æ–¥';
                        document.getElementById('game-turn').textContent = '–ê—Ç–∞–∫—É–π—Ç–µ –ø–æ–ª–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞';
                    }
                }, 500);
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ò–ò –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            getAIStrategy() {
                switch (this.gameState.difficulty) {
                    case 'easy': return 'random';
                    case 'medium': return Math.random() > 0.5 ? 'smart' : 'random';
                    case 'hard': return 'smart';
                    default: return 'random';
                }
            },
            
            // –ù–∞—á–∞–ª–æ –±–∏—Ç–≤—ã
            startBattle() {
                if (this.gameState.placedShips < 10) {
                    this.ws.showNotification('–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –∏–≥—Ä—ã!', 'error');
                    return;
                }
                
                this.gameState.status = 'player_turn';
                document.getElementById('game-status').textContent = '–í–∞—à —Ö–æ–¥';
                document.getElementById('game-turn').textContent = '–ê—Ç–∞–∫—É–π—Ç–µ –ø–æ–ª–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞';
                document.getElementById('start-game-btn').style.display = 'none';
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                this.startTimer();
                this.playSound('win');
            },
            
            // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
            startTimer() {
                clearInterval(this.gameState.timerInterval);
                this.gameState.gameTime = 0;
                
                this.gameState.timerInterval = setInterval(() => {
                    this.gameState.gameTime++;
                    const minutes = Math.floor(this.gameState.gameTime / 60);
                    const seconds = this.gameState.gameTime % 60;
                    document.getElementById('timer').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            },
            
            // –û–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã
            endGame(isWin) {
                clearInterval(this.gameState.timerInterval);
                this.gameState.status = 'ended';
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å
                const accuracy = this.gameState.totalShots > 0 
                    ? Math.round((this.gameState.hits / this.gameState.totalShots) * 100) 
                    : 0;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (this.currentUser) {
                    if (!this.currentUser.stats) {
                        this.currentUser.stats = { wins: 0, losses: 0, totalGames: 0, bestStreak: 0, currentStreak: 0 };
                    }
                    
                    this.currentUser.stats.totalGames = (this.currentUser.stats.totalGames || 0) + 1;
                    
                    if (isWin) {
                        this.currentUser.stats.wins = (this.currentUser.stats.wins || 0) + 1;
                        this.currentUser.stats.currentStreak = (this.currentUser.stats.currentStreak || 0) + 1;
                        
                        if (this.currentUser.stats.currentStreak > (this.currentUser.stats.bestStreak || 0)) {
                            this.currentUser.stats.bestStreak = this.currentUser.stats.currentStreak;
                        }
                        
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥
                        this.currentUser.rating = (this.currentUser.rating || 1000) + 25;
                    } else {
                        this.currentUser.stats.losses = (this.currentUser.stats.losses || 0) + 1;
                        this.currentUser.stats.currentStreak = 0;
                        
                        // –£–º–µ–Ω—å—à–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥
                        this.currentUser.rating = Math.max(0, (this.currentUser.rating || 1000) - 15);
                    }
                    
                    this.saveUser();
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
                this.showResultModal(isWin, accuracy);
                
                // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫
                this.playSound(isWin ? 'win' : 'lose');
            },
            
            // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
            showResultModal(isWin, accuracy) {
                const modal = document.getElementById('result-modal');
                const title = document.getElementById('result-title');
                const icon = document.getElementById('result-icon');
                const message = document.getElementById('result-message');
                const time = document.getElementById('result-time');
                const shots = document.getElementById('result-shots');
                const accuracyEl = document.getElementById('result-accuracy');
                const ratingChange = document.getElementById('result-rating-change');
                
                if (isWin) {
                    title.textContent = '–ü–û–ë–ï–î–ê!';
                    icon.textContent = 'üèÜ';
                    message.textContent = '–í—ã –ø–æ—Ç–æ–ø–∏–ª–∏ –≤—Å–µ –∫–æ—Ä–∞–±–ª–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞! –û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞!';
                    ratingChange.textContent = '+25';
                    ratingChange.style.color = '#4caf50';
                } else {
                    title.textContent = '–ü–û–†–ê–ñ–ï–ù–ò–ï';
                    icon.textContent = 'üíÄ';
                    message.textContent = '–í—Å–µ –≤–∞—à–∏ –∫–æ—Ä–∞–±–ª–∏ –ø–æ—Ç–æ–ø–ª–µ–Ω—ã. –ù–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!';
                    ratingChange.textContent = '-15';
                    ratingChange.style.color = '#f44336';
                }
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const minutes = Math.floor(this.gameState.gameTime / 60);
                const seconds = this.gameState.gameTime % 60;
                time.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                shots.textContent = this.gameState.totalShots;
                accuracyEl.textContent = `${accuracy}%`;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                modal.classList.remove('hidden');
            },
            
            // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∑–≤—É–∫–∞
            playSound(soundName) {
                if (!this.gameState.isSoundOn) return;
                
                const sound = this.sounds[soundName];
                if (sound) {
                    sound.currentTime = 0;
                    sound.play().catch(e => console.log('–ó–≤—É–∫ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω:', e));
                }
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞
            toggleSound() {
                this.gameState.isSoundOn = !this.gameState.isSoundOn;
                const icon = document.querySelector('#sound-toggle i');
                
                if (this.gameState.isSoundOn) {
                    icon.className = 'fas fa-volume-up';
                    this.playSound('click');
                } else {
                    icon.className = 'fas fa-volume-mute';
                }
            },
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            initEventListeners() {
                // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                document.getElementById('login-tab').addEventListener('click', () => this.switchAuthTab('login'));
                document.getElementById('register-tab').addEventListener('click', () => this.switchAuthTab('register'));
                document.getElementById('login-btn').addEventListener('click', () => this.login());
                document.getElementById('register-btn').addEventListener('click', () => this.register());
                
                // –õ–æ–±–±–∏
                document.getElementById('lobby-btn').addEventListener('click', () => this.showScreen('lobby'));
                document.getElementById('stats-btn').addEventListener('click', () => {
                    this.loadStats();
                    this.showScreen('stats');
                });
                document.getElementById('logout-btn').addEventListener('click', () => this.logout());
                
                // –†–µ–∂–∏–º—ã –∏–≥—Ä—ã
                document.getElementById('play-ai-btn').addEventListener('click', () => this.startGame('ai'));
                document.getElementById('create-room-btn').addEventListener('click', () => this.showCreateRoomModal());
                document.getElementById('find-match-btn').addEventListener('click', () => this.findOnlineMatch());
                
                // –ò–≥—Ä–∞
                document.getElementById('back-to-lobby-btn').addEventListener('click', () => this.returnToLobby());
                document.getElementById('surrender-btn').addEventListener('click', () => this.surrender());
                document.getElementById('random-placement-btn').addEventListener('click', () => this.placeShipsRandomly());
                document.getElementById('rotate-ship-btn').addEventListener('click', () => this.rotateShip());
                document.getElementById('clear-ships-btn').addEventListener('click', () => {
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –∏ –Ω–∞—á–∞—Ç—å —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–Ω–æ–≤–æ?')) {
                        this.startGame(this.gameState.mode);
                    }
                });
                document.getElementById('start-game-btn').addEventListener('click', () => this.startBattle());
                
                // –ß–∞—Ç
                document.getElementById('send-global-chat').addEventListener('click', () => this.sendChatMessage());
                document.getElementById('global-chat-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendChatMessage();
                });
                
                // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                document.getElementById('close-room-modal').addEventListener('click', () => {
                    document.getElementById('create-room-modal').classList.add('hidden');
                });
                document.getElementById('close-invite-modal').addEventListener('click', () => {
                    document.getElementById('invite-modal').classList.add('hidden');
                });
                document.getElementById('copy-invite-code-btn').addEventListener('click', () => this.copyInviteCode());
                document.getElementById('create-room-confirm-btn').addEventListener('click', () => this.confirmCreateRoom());
                document.getElementById('join-by-invite-btn').addEventListener('click', () => this.joinByInvite());
                
                // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã
                document.getElementById('play-again-btn').addEventListener('click', () => {
                    document.getElementById('result-modal').classList.add('hidden');
                    this.startGame(this.gameState.mode);
                });
                document.getElementById('back-to-lobby-from-result-btn').addEventListener('click', () => {
                    document.getElementById('result-modal').classList.add('hidden');
                    this.showScreen('lobby');
                });
                
                // –ó–≤—É–∫
                document.getElementById('sound-toggle').addEventListener('click', () => this.toggleSound());
            },
            
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            switchAuthTab(tab) {
                document.getElementById('login-tab').classList.toggle('active', tab === 'login');
                document.getElementById('register-tab').classList.toggle('active', tab === 'register');
                document.getElementById('login-form').classList.toggle('active', tab === 'login');
                document.getElementById('register-form').classList.toggle('active', tab === 'register');
                this.playSound('click');
            },
            
            // –í—Ö–æ–¥
            login() {
                const username = document.getElementById('login-username').value.trim();
                const password = document.getElementById('login-password').value;
                const messageEl = document.getElementById('login-message');
                
                if (!username || !password) {
                    this.showAuthMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error', messageEl);
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const users = JSON.parse(localStorage.getItem('seaBattleUsers') || '{}');
                
                if (!users[username]) {
                    this.showAuthMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error', messageEl);
                    return;
                }
                
                if (users[username].password !== password) {
                    this.showAuthMessage('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error', messageEl);
                    return;
                }
                
                // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
                this.currentUser = users[username];
                this.saveUser();
                this.showAuthMessage('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!', 'success', messageEl);
                this.playSound('win');
                
                setTimeout(() => {
                    this.showScreen('lobby');
                    this.updateUserDisplay();
                }, 1500);
            },
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            register() {
                const username = document.getElementById('register-username').value.trim();
                const password = document.getElementById('register-password').value;
                const email = document.getElementById('register-email').value.trim();
                const messageEl = document.getElementById('register-message');
                
                if (!username || !password) {
                    this.showAuthMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error', messageEl);
                    return;
                }
                
                if (username.length < 3 || username.length > 15) {
                    this.showAuthMessage('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 15 —Å–∏–º–≤–æ–ª–æ–≤', 'error', messageEl);
                    return;
                }
                
                if (password.length < 6) {
                    this.showAuthMessage('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error', messageEl);
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                const users = JSON.parse(localStorage.getItem('seaBattleUsers') || '{}');
                
                if (users[username]) {
                    this.showAuthMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error', messageEl);
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                this.currentUser = {
                    username,
                    email: email || '',
                    password,
                    rating: 1000,
                    stats: {
                        wins: 0,
                        losses: 0,
                        totalGames: 0,
                        bestStreak: 0,
                        currentStreak: 0
                    },
                    joined: new Date().toISOString()
                };
                
                this.saveUser();
                this.showAuthMessage('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!', 'success', messageEl);
                this.playSound('win');
                
                setTimeout(() => {
                    this.showScreen('lobby');
                    this.updateUserDisplay();
                }, 1500);
            },
            
            // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            showAuthMessage(text, type, element) {
                element.textContent = text;
                element.className = `auth-message ${type}`;
            },
            
            // –í—ã—Ö–æ–¥
            logout() {
                this.currentUser = null;
                localStorage.removeItem('seaBattleUser');
                this.showScreen('auth');
                this.playSound('click');
            },
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            loadStats() {
                if (!this.currentUser) return;
                
                const stats = this.currentUser.stats || { wins: 0, losses: 0, totalGames: 0 };
                const totalGames = stats.totalGames || 0;
                const wins = stats.wins || 0;
                const losses = stats.losses || 0;
                const winRate = totalGames > 0 ? Math.round((wins / totalGames) * 100) : 0;
                const rating = this.currentUser.rating || 1000;
                const bestStreak = stats.bestStreak || 0;
                
                document.getElementById('total-games').textContent = totalGames;
                document.getElementById('wins').textContent = wins;
                document.getElementById('losses').textContent = losses;
                document.getElementById('win-rate').textContent = `${winRate}%`;
                document.getElementById('rating').textContent = rating;
                document.getElementById('best-streak').textContent = bestStreak;
            },
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
            showCreateRoomModal() {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã
                const roomCode = this.ws.generateRoomId();
                document.getElementById('room-invite-code').textContent = roomCode;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('create-room-modal').classList.remove('hidden');
                this.playSound('click');
            },
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
            confirmCreateRoom() {
                const roomName = document.getElementById('room-name').value.trim();
                const isPrivate = document.getElementById('room-privacy').value === 'private';
                const roomCode = document.getElementById('room-invite-code').textContent;
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–º–Ω–∞—Ç—É —á–µ—Ä–µ–∑ WebSocket —Å–∏–º—É–ª—è—Ü–∏—é
                this.ws.createRoom(roomName || `–ö–æ–º–Ω–∞—Ç–∞ ${roomCode}`, isPrivate);
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('create-room-modal').classList.add('hidden');
                
                // –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É —Å –¥—Ä—É–≥–æ–º
                this.startGame('friend');
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã
                this.gameState.roomId = roomCode;
                this.ws.showNotification(`–ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞! –ö–æ–¥: ${roomCode}`, 'success');
            },
            
            // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
            copyInviteCode() {
                const code = document.getElementById('room-invite-code').textContent;
                navigator.clipboard.writeText(code).then(() => {
                    this.ws.showNotification('–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
                }).catch(err => {
                    this.ws.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥', 'error');
                });
                this.playSound('click');
            },
            
            // –ü–æ–∏—Å–∫ –æ–Ω–ª–∞–π–Ω –º–∞—Ç—á–∞
            findOnlineMatch() {
                this.ws.showNotification('–ü–æ–∏—Å–∫ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...', 'info');
                this.playSound('click');
                
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–∏—Å–∫ –º–∞—Ç—á–∞
                setTimeout(() => {
                    const found = Math.random() > 0.3; // 70% —à–∞–Ω—Å –Ω–∞–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
                    
                    if (found) {
                        this.ws.showNotification('–°–æ–ø–µ—Ä–Ω–∏–∫ –Ω–∞–π–¥–µ–Ω! –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É...', 'success');
                        setTimeout(() => {
                            this.startGame('online');
                        }, 1500);
                    } else {
                        this.ws.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –¥–ª—è –¥—Ä—É–≥–∞.', 'error');
                    }
                }, 2000);
            },
            
            // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é
            joinByInvite() {
                const inviteCode = document.getElementById('invite-code-input').value.trim().toUpperCase();
                
                if (!inviteCode) {
                    this.ws.showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è', 'error');
                    return;
                }
                
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
                const success = this.ws.joinRoom(inviteCode);
                
                if (success) {
                    document.getElementById('invite-modal').classList.add('hidden');
                    this.gameState.roomId = inviteCode;
                    this.startGame('friend');
                }
            },
            
            // –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
            invitePlayer(playerName) {
                this.ws.showNotification(`–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–≥—Ä–æ–∫—É ${playerName}`, 'success');
                this.playSound('click');
                
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    const accepted = Math.random() > 0.5;
                    
                    if (accepted) {
                        this.ws.showNotification(`${playerName} –ø—Ä–∏–Ω—è–ª –≤–∞—à–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ!`, 'success');
                        setTimeout(() => {
                            this.startGame('online');
                        }, 1000);
                    } else {
                        this.ws.showNotification(`${playerName} –æ—Ç–∫–ª–æ–Ω–∏–ª –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ`, 'error');
                    }
                }, 2000);
            },
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
            sendChatMessage() {
                const input = document.getElementById('global-chat-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                if (this.currentUser) {
                    this.ws.sendChatMessage(message);
                    input.value = '';
                    this.playSound('click');
                } else {
                    this.ws.showNotification('–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
                }
            },
            
            // –í–æ–∑–≤—Ä–∞—Ç –≤ –ª–æ–±–±–∏
            returnToLobby() {
                if (this.gameState.status === 'setup' || confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?')) {
                    clearInterval(this.gameState.timerInterval);
                    this.showScreen('lobby');
                    this.playSound('click');
                }
            },
            
            // –°–¥–∞—á–∞
            surrender() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–∞—Ç—å—Å—è?')) {
                    this.endGame(false);
                }
            }
        };
        
        // –î–µ–ª–∞–µ–º –æ–±—ä–µ–∫—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º
        window.SeaBattle = SeaBattle;
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        window.addEventListener('load', () => {
            SeaBattle.initApp();
        });
    </script>
</body>
</html>